<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Vulndb web user interface</title>

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">

    
    
    


</head>
<body>

    <div class="container">

        <div class="page-header">
            <a href="/"><h1>Vulndb web user interface</h1></a>
        </div>

        





<div class="row">
    <div class="col-md-12">
        <a href="/severity/high"><span class="label label-danger">high</span></a>
        
        
        <a href="/tag/web"><span class="label label-primary">web</span></a>

        
        <a href="/tag/file"><span class="label label-primary">file</span></a>

        
        <a href="/tag/upload"><span class="label label-primary">upload</span></a>

        
        
    </div>
</div>

<h2>Unrestricted file upload <small>#65</small></h2>


<div class="row">
    <div class="col-md-8"><h3>Description</h3></div>
</div>
<div class="row">
    <div class="col-md-8 text-justify"><p>Many web applications allow users to upload files that will either be stored or processed by the receiving web server.</p>

<p>It was possible to identify a form which allows files with arbitrary content and extension to be uploaded to the remote server, and then stores the uploaded file to a guessable path in the server&rsquo;s web root.</p>

<p>This could be used by a cyber-criminal to host content from the vulnerable server for phishing and Cross-Site Scripting attacks. In cases where the server is configured to execute scripts (PHP, Ruby, etc.) this vulnerability can be used to gain remote code execution on the server.</p>
</div>
</div>



<div class="row">
    <div class="col-md-8"><h3>Fix guidance <small>(10 minutes)</small></h3></div>
</div>
<div class="row">
    <div class="col-md-8 text-justify"><p>The identified form handler should at a minimum:</p>

<ol>
<li>Whitelist permitted file types and block all others. This should be conducted on the MIME type of the file rather than its extension.</li>
<li>As the file is uploaded, and prior to being handled (written to the disk) by the server, the filename should be stripped of all control, special, or Unicode characters.</li>
<li>Ensure that the upload is conducted via the HTTP <code>POST</code> method rather than <code>GET</code> or <code>PUT</code>.</li>
<li>Ensure that the file is written to a directory that does not hold any execute permission and that all files within that directory inherit the same permissions.</li>
<li>Scan (if possible) with an up-to-date virus scanner before being stored.</li>
<li>Ensure that the application handles files as per the host operating system. For example, the length of the file name is appropriate, there is adequate space to store the file, protection against overwriting other files etc.</li>
</ol>
</div>
</div>


<div class="row">
    <div class="col-md-8"><h3>References</h3></div>
</div>




<div class="row">
    <div class="col-md-8"><a href="https://www.owasp.org/index.php/Unrestricted_File_Upload">owasp.org</a> </div>
</div>






    </div>


    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

</body>
</html>